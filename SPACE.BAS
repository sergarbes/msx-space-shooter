100 ' SPACE SHOOTER

100 COLOR 15,1,1
110 SCREEN 1,2,0
120 DEFINT A-Z
125 bload"player.bin"
130 GOSUB 2000

199 CALL TURBO ON

200 ' INITIALIZATION
200 DIM EX(3),EY(3),EV(3),EW(3)
210 FOR I=0 TO 2
220     EX(I)=I*16
230     EY(I)=-16
240     EV(I)=0:EW(I)=0
250 NEXT I
260 T=0:ES=0
270 X=50:Y=100
271 BX=0: BY=0: BC=0

290 ON SPRITE GOSUB 800

291 REM enlazando con la rutina de ensamblador de inicio
292 DEFUSR=&HB000:pl=0
293 REM play music
294 A=USR(0):pl=1
295 REM enlazando con la rutina de ensamblador de stop music
296 DEFUSR2=&HB027

300 ' BEGIN OF GAME LOOP
300 '   UPDATE BLOCK
300 ON STICK(0) GOTO 310,320,330,340,350,360,370,380
305 GOTO 400
310 Y=Y-2:GOTO 400
320 Y=Y-2:X=X+2:GOTO 400
330 X=X+2:GOTO 400
340 Y=Y+2:X=X+2:GOTO 400
350 Y=Y+2:GOTO 400
360 Y=Y+2:X=X-2:GOTO 400
370 X=X-2:GOTO 400
380 Y=Y-2:X=X-2:GOTO 400
400 IF X<0 THEN X=0
410 IF X>120 THEN X=120
420 IF Y<0 THEN Y=0
430 IF Y>160 THEN Y=160

500 IF STRIG(0) AND BC<>15 THEN BX=X+7: BY=Y-3: BC=15
510 IF BC=15 THEN BY=BY-2: IF BY<0 THEN BX=160: BC=0

600 T=T+1:IF T=90 THEN T=0
610 IF (T MOD 10)=0 THEN IF ES=0 THEN ES=1 ELSE ES=0
620 IF (T MOD 30)<>0 THEN 630
621 EW(T\30)=2
622 EV(T\30)=RND(1)*4-2
623 EY(T\30)=0
624 EX(T\30)=RND(1)*120

630 FOR I=0 TO 2
640     EX(I)=EX(I)+EV(I):EY(I)=EY(I)+EW(I)
650     IF EX(I)<0 THEN EX(I)=0:EV(I)=-EV(I)
660     IF EX(I)>120 THEN EX(I)=120:EV(I)=-EV(I)
670     IF EY(I)>160 THEN EY(I)=-16:EX(I)=I*16:EV(I)=0:EW(I)=0
690 NEXT I

700 '   DRAW BLOCK
700 SPRITE OFF
710 PUT SPRITE 0,(X,Y),15,2
720 PUT SPRITE 1,(X,Y),4,3
730 PUT SPRITE 2,(BX,BY),BC,4
740 FOR I=0 TO 2
750     PUT SPRITE I+3,(EX(I),EY(I)),2,ES
760 NEXT I
770 SPRITE ON
780 IF TIME<2 THEN GOTO 780 ELSE TIME=0
790 GOTO 300

800 ' SPRITE COLISION SUBROUTINE
800 SPRITE OFF
810 FOR I =0 TO 2
820     ' CHECK BETWEEN ENEMY AND SPACESHIP
820     IF EX(I)+8>=X AND X+16>=EX(I) AND EY(I)+8>=Y AND Y+16>=EY(I) THEN GOSUB 900
830     ' CHECK BETWEEN ENEMY AND BULLET
830     IF EX(I)+8>=BX AND BX+1>=EX(I) AND EY(I)+8>=BY AND BY+3>=EY(I) THEN BX=160: BC=0: EY(I)=-16: EX(I)=I*16: EV(I)=0: EW(I)=0
840 NEXT I
850 RETURN

900 ' GAME OVER SUBROUTINE
900 'SCREEN 1,2,0 NO VA CON KUN
900 SCREEN 1,2
910 LOCATE 10,10: PRINT "GAME OVER"
915 LOCATE 0,15: PRINT "C TO PLAY AGAIN OR Q TO QUIT"
920 A$=INKEY$
930 'IF A$="Q" THEN pl=0:a=usr2(0):END ELSE GOTO 920
930 IF A$="Q" THEN pl=0:a=usr2(0):END ELSE IF A$="C" THEN pl=0:a=usr2(0):END ELSE GOTO 920

1000 ' ENEMY SPRITE 1
1000 DATA 18,3C,7E,DB,FF,24,5A,A5,00,00,00,00,00,00,00,00
1010 DATA 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
1020 ' ENEMY SPRITE 2
1020 DATA 18,3C,7E,DB,FF,5A,81,42,00,00,00,00,00,00,00,00
1030 DATA 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
1040 ' SACESHIP
1040 DATA 01,01,01,03,03,02,06,07,0F,0E,1C,3C,7E,F7,E3,C1
1050 DATA 00,00,00,80,80,80,C0,C0,E0,E0,70,78,FC,DE,8E,06
1070 ' SPACEHIP COLOR DETAIL
1070 DATA 00,00,00,00,00,01,01,00,00,01,03,03,01,00,00,00
1080 DATA 00,00,00,00,00,00,00,00,00,00,80,80,00,00,00,00
1090 ' BULLET
1100 DATA 80,80,80,00,00,00,00,00,00,00,00,00,00,00,00,00
1110 DATA 00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00
1120 DATA *

2000 ' LOAD SPRITES SUBROUTINE
2000 S=&H3800
2010 READ R$
2020 IF R$="*" THEN RETURN ELSE VPOKE S,VAL("&H"+R$):S=S+1
2040 GOTO 2010
